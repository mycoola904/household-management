{% extends "base.html" %}
{% block title %}Categories Â· Household{% endblock %}
{% block content %}
<div class="flex items-center justify-between mb-6">
    <div>
        <h1 class="text-2xl font-semibold">Categories</h1>
        <p class="text-base-content/70">Organize transactions with reusable labels.</p>
    </div>
    <button class="btn btn-primary"
            hx-get="{% url 'finance:category-create' %}"
            hx-target="#modal-body"
            hx-swap="innerHTML">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-5 h-5">
            <path fill-rule="evenodd" d="M12 4.5a.75.75 0 01.75.75v6h6a.75.75 0 010 1.5h-6v6a.75.75 0 01-1.5 0v-6h-6a.75.75 0 010-1.5h6v-6A.75.75 0 0112 4.5z" clip-rule="evenodd" />
        </svg>
        New Category
    </button>
</div>
<div class="overflow-x-auto bg-base-100 rounded-box shadow">
    <table class="table table-zebra">
        <thead>
            <tr class="text-sm uppercase text-base-content/70">
                <th class="w-1/3">Name</th>
                <th>Slug</th>
                <th>Status</th>
                <th class="text-right">Actions</th>
            </tr>
        </thead>
        <tbody id="category-rows"
               hx-get="{% url 'finance:category-list' %}"
               hx-trigger="load, categoriesChanged from:body"
               hx-target="this"
               hx-swap="innerHTML">
            {% include "finance/partials/category_rows.html" %}
        </tbody>
    </table>
</div>
<dialog id="account-modal" class="modal">
    <div class="modal-box w-11/12 max-w-2xl" id="modal-body"></div>
    <form method="dialog" class="modal-backdrop">
        <button>Close</button>
    </form>
</dialog>
<script>
    const accountModal = document.getElementById('account-modal');
    document.addEventListener('htmx:afterSwap', function (event) {
        if (event.target.id === 'modal-body') {
            accountModal.showModal();
        }
    });
    document.addEventListener('closeAccountModal', function () {
        if (accountModal.open) {
            accountModal.close();
        }
        document.getElementById('modal-body').innerHTML = '';
    });
    accountModal.addEventListener('close', function () {
        document.getElementById('modal-body').innerHTML = '';
    });
</script>
{% endblock %}
